---
title: "Partie_2"
author: "AmigoTeam"
date: "2024-04-09"
output: html_document
bibliography: AmigoTeam.bib
---
# Une modèle pour déterminer l'effet des différente intensité des ouragans sur le long terme des récifs corailiens.  

Par Antoince Castonguay et Félix Richard. L'AmigoTeam.  
antoine.castonguay@usherbrooke.ca  
felix.richard3@usherbrooke.ca  

## Introduction
Pour lutter contre la dégradation des récifs coralliens, il est crucial d'agir pour préserver cette ressource inestimable qui favorise la biodiversité des océans. Le modèle développé par Blackwood, J.C., Hastings, A. et Mumby, P.J. en 2011 est particulièrement intéressant, car il décrit bien les effets de plusieurs stress et leurs interactions sur la survie des coraux à long terme. 

Ils aborent premierement la compétition de l'espace entre les macroalgue et les coraux. Deuxiemement, ils ajoute au modele la relation consomateur-ressource entre les parrofishs et les macroalgues. En troisieme lieu, la rugosité des coraux est également considérée comme un élément crucial pour la capacité de soutien des populations de parrofishs, tandis que l'effort de pêche joue un rôle important sur la population de parrofishs. Enfin, le modèle inclut un élément stochastique représenté par les ouragans, qui ont un impact sur les populations de coraux, de macroalgues et sur la rugosité des coraux. 

Dans notre étude, nous avons cherché à rendre ce modèle plus réaliste en y ajoutant une composante plus variable et aléatoire simulant de manière plus précise l'impact réel des ouragans. De plus, nous avons intégré une augmentation de la l'intensité des ouragan au fil des années, ce qui reflète la situation actuelle avec les changements climatiques.

## Méthode
Dans ce modele, nous avons concentrer nos efforts sur F() et G() ansi qu'un nouveau parametre i qui caractérise la farce de l'impact. 

Notre objectif est d'améliorer

Modèle avec implémentation d'ouragans stochastique:  
$\small{dC = g_C(C,M,P,R,t)dt - C(F() + \sigma \epsilon)idq}$  
$\small{dM = g_M(C,M,P,R,t)dt - Mm_Hidq}$  
$\small{dP = g_P(C,M,P,R,t)dt}$  
$\small{dR = g_R(C,M,P,R,t)dt - (R-1)(G() + \sigma \epsilon)idq}$  
$\small{dY = 1 - M - C}$  

$\small{F() = 0.0512 + 0.0176*te}$ avec un maximun de F() = 0.5.

$\small{g_C(C,M,P,R,t) = rTC - dC - aMC}$   
$\small{g_M(C,M,P,R,t) = aMC} - \frac{\alpha \frac{P}{\beta}M}{M + Y} - \small{\gamma MY}$  
$\small{g_P(C,M,P,R,t) = sP(1 -} \frac{P}{\beta K(M+T,R)} \small{ - sfP}$  
$\small{g_R(C,M,P,R,t) = h_GC(3-R) - h_E(1-C)(R-1)}$  

$\small{K(M+T,R) = }\frac{(c1R + c2)}{K_{max}}\frac{\delta(M+Y)}{1 + v(M+Y)}$

$F() = 0.0512 + 0.0176*te$ avec un maximun de F() = 0.5.

<div style="width: 85%; margin: 0 auto;">
#### Tableau 1 : Paramètre utiliser dans le modèle de référence et leurs définitions.
| Paramètre | Valeur | Définition |
|:--:|:----:|:--------------|
| s | 0.49 | Taux de croissance du parrofish par année |
| r | 1 |  Taux pour lequel le corail remplace le gazon d'algue par année (Taux de coissance du corail) |
| a | 0.1 | Taux pour lequel les macroalgues remplace le corail par année |
| gamma | 1.6,0.8 | Taux pour lequel les macroalgues remplace le gazon d'algue par année |
| d | 0.44 | Taux de mortalité du corail par année |
| Alpha | 1 | Taux de broutage maximale par le parrofish |
| f | variable | Effort de pêche en pourcentage |
| c1,c2 | 3.65,-3.21 | Détermine la relation entre la complexité du corail et la capacité de support du parrofish |
| delta,v | 4.557,0.9877 | Détermine la relation entre la nourriture disponible et la capacité de support du parrofish |
| Beta | 1 | Capacité de support de l'environnement pour le parrofish théorique et relatif |
| hG | 0.03 | Rétablissement de la complexité du corail par année |
| hE | 0.01 | Érosion de la complexité du corail par année |
| kmax | 17.745 | Limite supérieure d'abondance des parrofishs |
| F() | 0.0512 + 0.0176*te | La proportion de la couverture corallienne maximun affectée par un ouragan respectivement |
| G() |  | La proportion attendue de rugosité affectée au maximun par les impacts des ouragans respectivement |
| mH | 0.8 | Taux de mortalité des macroalgues maximun suite a un ouragan |
| te | varaible | Temps écouler depuis le dernier ouragan en année |
| sigma | 0.05 | Écart maximale de la variabilité des impacts des oragans d'epsilon |
| epsilon | entre 0 et 1 | Variable aléatoire suivant une distribution normale standard qui décrit la composante aléatoire des impacts des oragans sur le corail |
| i | entre 0 et 1 | Pourcentage d'impacte des ouragants |

#### Tableau 2 : Variable utiliser dans le modèle de référence et leur définition anisi que leurs limites.
| Variable | Valeur possible | Définition |
|:--:|:----:|:--------------|
| C | entre 0 et 1 | Correspond à la proportion de couverture du paysage par le corail. Où 1 est une couverture complete et où 0 est l'extinction des corail. |
| M | entre 0 et 1 | Correspond à la proportion de couverture du paysage par les macroalgues. Où 1 est une couverture compete et où 0 est l'extinction des macroalgue. |
| P | entre 0 et 1 | Correspond à la population des parrofishs. Où 1 est lorsque la capacité de support maximale est atteind et où 0 est l'extinction des parrofishs |
| R | entre 1 et 3 | Correspond à la rugosité des recif corralien. Où 1 équivaut à une structrue parfaitement lisse et où 3 est un rugosité très pronnoncer rarement atteint qui équivaut a un récif corailien offrant une tres bonne qualité d'habitat. |
| Y | entre 0 et 1 | Le gazon d'algue correspond a tout ce qui n'est pas corail et macroalgue. |
</div>

Afin d'ajouter au modèle stochastique de l'article de Blackwood et al.(2011), nous avons modifié légèrement le modèle pour tenter de se débarrasser des catégories d'impact en les remplaçant par un coefficient d'impact continu. Cette démarche a pour but de pouvoir plus facilement visualiser la gradation de l'effet de la puissance des ouragans sur la résilience du corail dans diverses situations. Dans un contexte de changements climatiques, nous nous attendons à percevoir des différences au niveau de l'ampleur des phénomènes météorologiques tels que les ouragans. Nous nous sommes basés sur le document de Cervantes et al. (2020) sur les relations entre les caractéristiques des ouragans, la structure du récif de corail et l'impact de ces perturbations sur la rugosité et le couvert. 

Avant tout, nous nous sommes débarrassé des 3 niveaux d'impacts qui étaient implémentés dans le modèle proposé par Blackwood et al. (2011). Dans leur cas, un ouragan avec impact qualifié de fort ou modéré a pour effet de réduire d'un pourcentage $F+\sigma\epsilon$ le couvert de corail, où $F$ est une fonction du temps écoulé depuis le dernier ouragan $t_o$, de sorte que l'impact soit en moyenne linéairement plus grand plus le dernier ouragan date, jusqu'à concurrence de 50% de réduction, qui est atteinte quand le dernier ouragan s'est passé il y a 25.5 années ou plus. La composante $\sigma$ est une variance fixée à 0,05 et $\epsilon$ est tiré aléatoirement d'une distribution normale, le tout pour conférer une certaine variabilité à l'effet sur le couvert de corail. Les ouragans de faible puissance sont ici considérés comme ne réduisant pas significativement le couvert de corail. L'effet sur la rugosité est fixé à 50% de réduction, sur une échelle allant de 3 à 1 (50% d'une rugosité de 3 résulte en une rugosité de 2), dans le cas d'un ouragan à impact fort, à 5% de réduction pour un ouragan à faible intensité tandis que dans le cas d'un ouragan d'intensité modéré, la réduction de la rugosité est calculée de la même façon que celle du couvert de corail. Le dommage causé aux macroalgues est considéré par ce modèle comme constant peu importe l'intensité des ouragans, avec une perte ($m_H$) de 80% du couvert M lors d'un évènement d'ouragan.

Le $F$ est calculé ici en fonction de $t_o$, et est borné entre 0 et 0.5 selon l'équation suivante:
$F(t_o)=0.0512+0.176\times t_o$ quand $t_o\leq25.5$ années
$F(t_o)=0.5$ quand $t_o>25.5$ années

On obtient ainsi les équations suivantes pour déterminer le dommage à chaque composante, dans le cas où un ouragan survient:

Ouragan à fort impact:

+ $dC=C\times (F+\sigma \epsilon)$
+ $dM=M\times m_H$
+ $dR=(R-1)\times 0.5$

Ouragan à impact modéré:

+ $dC=C\times (F+\sigma \epsilon)$
+ $dM=M\times m_H$
+ $dR=(R-1)\times (F+\sigma \epsilon)$

Ouragan à impact faible:

+ $dC=0$
+ $dM=M\times m_H$
+ $dR=(R-1)\times 0.05$

Le $F$ est déterminé par l'équation suivante: $F(t_o)=0.$

Pour le modèle que nous proposons, la première modification apportée est que nous fixons un coefficient d'impact $i$ pour la simulation qui agit sur le dommage subi par chaque composante. Ainsi ce coefficient d'impact d'une valeur variant entre 0 et 1 dicte le dommage subi par les différents éléments de la simulation. Nous ajustons l'étendue possible de $dC$, $dM$ et $dR$ afin que la variabilité des dommages entre un coefficient d'impact à 1 et un coefficient d'impact à 0 corresponde aux limites de ce qui est observé par le document de Cervantes et al. (2020). Ainsi, la perte de couvert de corail est également proportionnel à $F$, mais est bornée à 0% quand $i\in [0,0.3]$, correspondant à un ouragan de trop faible intensité pour réduire le couvert coralien, et varie linéairement entre 0% et 75% quand $i\in[0.3,1]$. Pour le couvert de macroalgues, le dommage subi reste en moyenne le même, soit 80%, mais le coefficient d'impact ajoute une variabilité de 25% qui fait en sorte que le dommage varie proportionnellement entre 60% et 100% selon la valeur de $I$. Cette modification pallie partiellement le fait qu'en situation d'ouragan plutôt faible, les macroalgues sont désavantagées par rapport au corail. Pour la rugosité, la littérature semblait démontrer que la proportion de rugosité perdue était proportionnelle à la valeur de rugosité elle même, nous avons donc ajouté la composante $G=0.1\times (R-1)$ ainsi qu'une relation avec $i$ faisant ainsi varier $dR$ entre 0 et 50% selon $R$ et $i$, mais seulement limité entre 0% et 5% si $i=0$. 

Une autre modification que nous avons apportée au modèle est une forme d'accélération du rythme auquel la valeur de F augmente. Avec les années qui passent, nous supposons que les dégâts des ouragans deviendront plus grave plus rapidement en fonction du temps écoulé depuis le dernier ouragan, à cause des changements climatiques. Ainsi, si au début de la simulation, il faut 25.5 années pour que F atteigne son maximum à 0.5, graduellement cette période sera raccourcie pour être de seulement 17 années à la fin. Les équations déterminant le dommage à chaque composante du système lors d'un ouragan est donc défini par les équations suivantes:

+ $dC=C\times (F+ \sigma \epsilon)\times (2\times i-0.5)$ où on pose que si $dC<0$, alors $dC=0$
+ $dM=M\times m_H\times(0.5\times i+0.75)$
+$dR=(R-1)\times(G + \sigma\epsilon)\times(2.25\times i+0.25)$ où $G=0.1\times (R-1)$
+$F(t_o)=0.0512+0.0176\times t_o\times(1+t/200)$ où si $F(t_o)>0.5$ alors $F(t_o)=0.5$

La fonction de la simulation du modele XXX a été dévelloper. La fonction prend en argument la rugosité de départ (R0), l'effort de pêche (f), la fréquence moyenne estimer des ouragan dans la zone des récit corailien (lamda), le niveau d'impact de l'ouragan (impact) et la duré des pas de temps sachant que 1 équivaut a faire un pas de temps d'une année (dt). Après une simulation de 100 ans, la fonction nous retourne la valeur de couverture du paysage par le corail et sa rugosité.

```{r}
corailstochastiquev2 <- function (R0,f,lambda=1/30,impact=0.5,dt=1,graph=FALSE){
  #on instaure une étendue de temps
  tmax <- 100
  t <- 0
  #le temps au dernier ouragan, en tenant compte que la simulation ne commence pas nécessairement juste après un ouragan
  to <- runif(1,0,25.5)
  
  #on pose les valeurs de départ et les paramètres
  C <- 0.56
  M <- 0.01
  Y <- 0.43
  R <- R0
  P <- 0.5
  a<-0.1
  g<-0.8
  d<-0.44
  r<-1
  f<-f
  s<-0.49
  ca<--(3.21)
  cb<-3.65
  kmax<-17.745
  delta<-4.557
  v<-0.9877
  hG<-0.03
  hE<-0.01
  o <- 0.05
  mH <- 0.8
  
  #on initie les vecteurs de résultats
  vecC <- C
  vecM <- M
  vecY <- Y
  vecR <- R
  vecP <- P
  
  while (t<tmax){
    
    #on effectue le tirage pour déterminer si il y a ou pas ouragan
    ouragan <- pmin(rpois(1,lambda*dt),1)
    #si oui ou non, on ajuste dq
    if (ouragan==1){
      
      #on calcule le temps depuis le dernier ouragan
      te <- t - to
      
      #on sauve le nouveau temps de dernier ouragan
      to <- t
      
      #on calcule F
      F <- pmin(0.0512 + 0.0176*(t/200+1)*te, 0.5)
      G <- (R-1)*0.1
      
      #différents dommage selon valeur d'impact
      
      #on calcule les dommages d'un fort ouragan
      dommM <- M*mH*(0.75+impact*0.5)
      dommC <- C*(F + o*runif(1))*pmax(2*impact-0.6,0)
      dommR <- (R-1)*(G + o*runif(1))*(impact*2.25+0.25)
      
    }else{
      dommC <- 0
      dommM <- 0
      dommR <- 0
    }
    
    #on calcule les changements
    dC <- ((r)*Y*C - (d)*C - (a)*M*C)*dt - dommC
    dM <- ((a)*M*C - ((1)*P*M/(M+Y)) + (g)*M*Y)*dt - dommM
    dP <- ((s)*P*(1 - (P/((((ca+cb*R)/kmax)*((delta*(M+Y))/(1+v*(M+Y))))))) -(f*s)*P)*dt 
    dR <- ((hG)*C*(3 - R) - (hE)*(1 - C)*(R - 1))*dt - dommR
    
    #on effectue les changements
    C <- pmax(C + dC,0.0001)
    M <- pmax(M + dM,0.0001)
    P <- pmax(P + dP, 0.0001)
    R <- R + dR
    Y <- 1 - M - C
    
    #on sauve les nouvelles valeurs dans leur vecteurs
    vecC <- c(vecC,C)
    vecM <- c(vecM,M)
    vecY <- c(vecY,Y)
    vecR <- c(vecR,R)
    vecP <- c(vecP,P)
    
    #on fait avancer le temps
    t <- t + dt
  }
  #si on veut afficher le graphique
  if (graph==TRUE){
    par(mfrow=c(1,1))
    plot(seq(0,tmax,length.out = length(vecC)),vecC, type="l", col="red", ylim=c(0,1), xlab= "temps", ylab="valeurs")
    axis(side = 4,at= seq(0,1,0.1),labels = seq(1,3,0.2), )
    lines(seq(0,tmax,length.out = length(vecM)),vecM, col="blue")
    lines(seq(0,tmax,length.out = length(vecP)),vecP, col="green")
    lines(seq(0,tmax,length.out = length(vecR)),(vecR-1)/2, col="pink")
    legend("topright", legend = c("corail", "macroalgues","poissons","rugosité"),
           col = c("red","blue","green","pink"), lty = c(1, 1),
           lwd = 2, bg = "white",cex = 0.75)
  }
  #retourne la valeur finale de C et de R
  return(c(tail(vecC,1),tail(vecR,1)))
}
```

## Résultat

La relation entre la rugosité et le niveau d'impact des ouragants sur les récif corialien avec 3 niveau d'effort de peche : 

Pour répondre a la question des effets des différente intensité des ouragans sur les récifs corailiens à long terme, on s'est dabord interesser à la relation qui il y avait entre la rugosité de départ et le niveau de l'intesité des ouragants. Nous avons fixer la fréquence des ouragan sur une meme zone de récif coralien avec une probabilité d'environs 1 aux 15 année et avons étudier trois différent effort de pêche soit 0.1, 0.4 et 0.7. C'est trois effort de peche represent un niveau faible, moyen et fort de peche. 

```{r,eval=FALSE}
library(fields)
#graphique de C en fonction de I et R
graph.imageCIR <- function(fishing,freq,it=10,pas=0.1){
  
  matC <- matrix(0, nrow = 21,ncol = 26)
  matsd <- matrix(0, nrow = 21,ncol = 26)
  
  
  f0<-fishing
  l<-freq
  for (i in 1:21) {
    for (j in 1:26){
      res <- vector(length = 0)
      for (z in 1:it) {
        R1 <- i*0.1+0.9
        imp <- j*0.04-0.04
        w <- corailstochastiquev2(R0=R1,f=f0, lambda = l,impact = imp,dt=pas, graph = F)[1]
        res<-c(res,w)
      }
      matC[i,j]<-mean(res)
      matsd[i,j]<-sd(res)
    }
  }
  
  x_values <- seq(0, 1, length.out = ncol(matC))
  y_values <- seq(1, 3, length.out = nrow(matC))
  # Plot the matrix as an image with different colored pixels
  
  par(mfrow=c(1,2))
  image.plot(x = x_values, y = y_values, t(matC), col = viridis(20), zlim = c(0,0.56),
             xlab = "impact", ylab = "Rugosité initiale", 
             main=c("moyenne de C finale",paste(c("fréq:1/",1/l,", fishing:",f0),collapse = "")))
  image.plot(x = x_values, y = y_values, t(matsd), col = viridis(20),
             xlab = "impact", ylab = "Rugosité initiale",
             main=c("écart-type de C finale",paste(c("fréq:1/",1/l,", fishing:",f0),collapse = "")))
}
graph.imageCIR(fishing = 0.1, freq = 1/15, it=2, pas = 0.5)
graph.imageCIR(fishing = 0.4, freq = 1/15, it=2, pas = 0.5)
graph.imageCIR(fishing = 0.7, freq = 1/15, it=2, pas = 0.5)
```

Un point à noter est que les trois simulations possèdent une large étendue d'écart-type, les écarts maximum allant jusqu'à 30% pour une même simulation. Il est aussi interessant de noter qu'avec un effort de peche plus important, la rugosité minimal pour une résilence des coraux augmente. De plus, un tendance générale soutient que plus l'impact est élver, plus il y a d'instabilité dans la situation des coraux.

```{r,eval=FALSE}
#graphique de R finale en fonction de I et R
graph.imageRIR <- function(fishing,freq,it=10,pas=0.1){
  
  matC <- matrix(0, nrow = 21,ncol = 26)
  matsd <- matrix(0, nrow = 21,ncol = 26)
  
  
  f0<-fishing
  l<-freq
  for (i in 1:21) {
    for (j in 1:26){
      res <- vector(length = 0)
      for (z in 1:it) {
        R1 <- i*0.1+0.9
        imp <- j*0.04-0.04
        w <- corailstochastiquev2(R0=R1,f=f0, lambda = l,impact = imp,dt=pas, graph = F)[2]
        res<-c(res,w)
      }
      matC[i,j]<-mean(res)
      matsd[i,j]<-sd(res)
    }
  }
  
  x_values <- seq(0, 1, length.out = ncol(matC))
  y_values <- seq(1, 3, length.out = nrow(matC))
  # Plot the matrix as an image with different colored pixels
  
  par(mfrow=c(1,2))
  image.plot(x = x_values, y = y_values, t(matC), col = viridis(20), 
             xlab = "impact", ylab = "Rugosité initiale", 
             main=c("moyenne de R finale",paste(c("fréq:1/",1/l,", fishing:",f0),collapse = "")))
  image.plot(x = x_values, y = y_values, t(matsd), col = viridis(20),
             xlab = "impact", ylab = "Rugosité initiale",
             main=c("écart-type de R finale",paste(c("fréq:1/",1/l,", fishing:",f0),collapse = "")))
}
graph.imageRIR(fishing = 0.1, freq = 1/15, it=2, pas = 0.5)
graph.imageRIR(fishing = 0.4, freq = 1/15, it=2, pas = 0.5)
graph.imageRIR(fishing = 0.7, freq = 1/15, it=2, pas = 0.5)

```



# Discution 

Dans le cadre des analyse entre la rugosité et l'impact des ouragane avec trois niveau d'effort de peche plusieur élément sont ressortie des résultat. Un premier élément est que les trois simulations possèdent une large étendue d'écart-type, les écarts maximum allant jusqu'à 30% pour une même simulation. Un écart-type plus prononcer équivaut a une intabilité entre les populations de l'Ecosysteme. 


Il est interessant de noter qu'avec un effort de peche plus important, la rugosité minimal pour une résilence des coraux augmente. De plus, un tendance générale soutient que plus l'impact est élver, plus il y a d'instabilité dans la situation des coraux.

Premierement, il y a tres peux de fluxtuation dans le graphique qui represent l'état des récif coralien avec un effort de peche de 1. En effet, peu import le niveau de rugosité de départ à l'exption de 1 très peu de fluctuation est noté. Cela implique qu'avec un niveau d'effort de peche faible l'ecosysteme se rétablie tres bien peu importe le niveau d'impact des ouragans. 

Dans le cas, 

# Référence